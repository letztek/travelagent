# Specification: 初步行程概念與路線預覽 (US-103)

## 概述
本 Track 旨在實作一個中繼步驟：在生成詳細行程表格之前，先由 AI 規劃一個高層次的「路線骨架」（例如：城市順序與規劃理由）。這能讓顧問在投入大量 Token 生成細節前，先確認大方向是否正確。

## 業務需求 (US-103)
- **觸發時機**：在完成「需求收集與 AI 診斷」後，系統優先呼叫「路線規劃」。
- **AI 規劃邏輯**：
  - 依據需求中的出發地、目的地及天數，規劃最順暢的城市流向。
  - 避免回頭路，考慮交通樞紐（機場、高鐵站）的便捷性。
- **產出結果 (Route Concept)**：
  - **節點清單**：每日的核心區域或城市（例：Day 1 仙台、Day 2 青森）。
  - **規劃理由 (Rationale)**：為什麼這樣排？（例：採逆時針順序節省交通時間）。
  - **交通方式建議**：段落間的大交通方式（飛機、JR、自駕）。
- **使用者互動**：
  - 顯示流程圖或時間軸。
  - 顧問可點擊「確認路線並生成細節」或「重新調整需求」。

## 技術規範
- **AI Skill**: 建立 `route-planner` skill。
- **UI 呈現**: 使用 Lucide 圖示與 Shadcn Card 實作垂直/水平時間軸。
- **流程整合**:
  - `Gap Analysis` 完成 -> 跳轉至 `Route Preview`。
  - `Route Preview` 確認 -> 呼叫 `Itinerary Generation` (US-104)。

## 資料模型
- **Itinerary 表擴充**：暫時將路線骨架儲存在 `itineraries` 的 `route_concept` 欄位（JSONB）。
